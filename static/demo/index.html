<!DOCTYPE html>
<html>

<head>
	<title>electrocute demo</title>
	<link rel="stylesheet" href="//cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
	<script src="//cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
	<style>
		html,
		body {
			margin: 0;
			height: 100%;
		}

		body {
			font: 16px/1.4 "Helvetica Neue", Arial, sans-serif;
		}

		.ghbtns {
			position: relative;
			top: 4px;
			margin-left: 5px;
		}

		a {
			color: #0077ff;
		}

		.flex-container {
			display: flex;
			flex-direction: row;
			flex-wrap: nowrap;
			justify-content: flex-start;
			align-content: stretch;
			align-items: flex-start;
		}

		.flex-item:nth-child(1) {
			order: 0;
			flex: 1 1 auto;
			align-self: stretch;
		}
	</style>
</head>

<body class="flex-container">
	<div id="map" class="flex-item"></div>

	<script src="../src/simpleheat.js"></script>
	<script src="../src/HeatLayer.js"></script>

	<script src="../dist/leaflet-heat.js"></script>

	<script src="datapoints.js"></script>
	<script>
		var map = L.map('map').setView([53.266453, -7.638463], 7);

		var tiles = L.tileLayer('//{s}.tile.osm.org/{z}/{x}/{y}.png', {
			attribution: '&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors',
		}).addTo(map);

		addressPoints = addressPoints.map(function (p) { return [p[0], p[1]]; });

		var request = new XMLHttpRequest();

		request.open("GET", "../forecast.json");
		request.addEventListener('load', function (event) {
			if (request.status >= 200 && request.status < 300) {
				var json = JSON.parse(request.responseText).map(function (p) { return [p.lat, p.lon]; });
				draw(json);
			} else {
				console.warn(request.statusText, request.responseText);
			}
		});
		request.send();

		function draw(addressPoints) {
			var heat = L.heatLayer(addressPoints, {
				minOpacity: 0.7,
				maxZoom: 10,
				radius: 60,
				blur: 60,
				max: 1.0
			}).addTo(map);
		}
	</script>
</body>

</html>
